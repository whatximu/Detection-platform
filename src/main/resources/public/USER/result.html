<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">

    <title>XX检测平台</title>
    <link rel="icon" href="../../static/demo1/img/013.png" type="image/x-icon">
    <link rel="stylesheet" href="../../static/layui/css/layui.css" media="all"/>
    <!-- import CSS -->
    <link rel="stylesheet" href="https://unpkg.com/element-ui/lib/theme-chalk/index.css">
</head>
<body class="layui-layout-body">

<div class="layui-layout layui-layout-admin">
    <div class="layui-header">
        <ul class="layui-nav" >
            <li class="layui-nav-item">
                <a href="http://localhost:8081/USER/form.html">问题上传</a></li>
            <li class="layui-nav-item">
                <a href="http://localhost:8081/USER/list.html">问题查看</a></li>
            <li class="layui-nav-item">
                <a href="http://localhost:8081/USER/repairTable.html">售后维修</a></li>

        </ul>

        <ul class="layui-nav layui-layout-right">
            <li class="layui-nav-item">
                <a href="javascript:;" id="usernameinfo">

                </a>
                <dl class="layui-nav-child">
                    <dd><a href="">基本资料</a></dd>
                    <dd><a href="">安全设置</a></dd>
                </dl>
            </li>
            <li class="layui-nav-item"><a href="http://localhost:8081/">退出</a></li>
        </ul>
    </div>

    <div class="layui-tab layui-tab-brief" lay-filter="demoTitle">
        <div class="layui-body layui-tab-content site-demo site-demo-body">

            <div id="el-form-steps">


                <div class="layui-tab-item layui-show">
                    <div class="layui-main">
                        <div id="LAY_preview">
                            <div style="height: 80px">
                                <div style="height: 20px"></div>
                                <h2>进度</h2>
                            </div>

                            <div >

                                    <row style="display:inline-block;text-align:center;width:1020px;" id="percent">
                                    </row>
                                <div style="height: 30px"></div>

                                <div id="hang">

                                </div>
                                <div style="height: 20px"></div>
                                <div id="repairs">

                                </div>
                            </div>
                        </div>
                    </div>


                </div>

            </div>

        </div>
    </div>

</div>


<script src="../../static/layui/layui.js" charset="utf-8"></script>
<script src="../../js/jquery.min.js"></script>
<script src="../../js/jquery.cookie.js"></script>

<script>
    var name=$.cookie('name');
    var username=$.cookie('username');
    var  id =$.cookie('id');
    var user_submit={"username":username,"id":id};

    usr={"username":username,"id":id};
    Pushax();


    function Pushax() {

        $.ajax({
            url:"http://localhost:8081/result/get",
            data:JSON.stringify(usr),
            type: "POST",
            async: true,
            dataType:"json",
            contentType: "application/json; charset=utf-8",

            success:function(result){

                describe=JSON.stringify(result.describe);

                console.log(result.describe)
                describe=JSON.parse(describe);
                var str = "";


                var n = 0;
                var a=result.code
                var b=result.active_percent

                var str2= ' <el-progress :width="300" :height="300" type="circle" :percentage='+b+'></el-progress>'

                document.getElementById("percent").innerHTML=str2;

                str+=  '<el-steps :active='+a+' align-center id="hang">'


                var length=describe.length;
                for (i=0;i<length;i++){
                    var a=[];
                    for (var key in describe[i]){
                        a.push(describe[i][key])

                    }
                    // str += '<el-step title="'+a[0]+'" description="'+a[1]+'"></el-step>';
                    str += '<el-step title="'+a[0]+'"></el-step>';
                }


                str+='</el-steps>'



                console.log(str)




                document.getElementById("hang").innerHTML=str;
                document.getElementById("percent").innerHTML=str2;
                var listRepair = result.listRepair;
                console.log(listRepair);
                var listRepairStr = "";
                for (i = 0; i < listRepair.length; i++){
                    var repair = listRepair[i];
                    listRepairStr += '<el-card class="box-card">';
                    listRepairStr += '  <div slot="header" class="clearfix">\n' +
                        '    <span>维修记录'+(i+1)+'</span>\n' +
                        '  </div>';
                    listRepairStr+= '<div class="text item">维修日期：'+repair.repairdate+'</div>';
                    listRepairStr+= '<div class="text item">更换零件名称：'+repair.repairname+'</div>';
                    listRepairStr+= '<div class="text item">详细维修内容：'+repair.repairdocs+'</div>';
                    listRepairStr+= '<div class="text item">其他：'+repair.repairload+'</div>';
                    listRepairStr+= '<div class="text item">维修结果：'+repair.whether+'</div>';
                    listRepairStr+='</el-card>';
                }
                document.getElementById("repairs").innerHTML=listRepairStr;

            },



        })



    }


    var str= '<img src="../../static/userimage/0.jpg" class="layui-nav-img" >'+name
    document.getElementById("usernameinfo").innerHTML=str;

    Push2();

    function Push2() {
        $.ajax({
            url:"http://localhost:8081/result/change",
            data:JSON.stringify(user_submit),
            type: "POST",
            async: true,
            dataType:"json",
            contentType: "application/json; charset=utf-8",

            success:function(result){

                console.log("change")

            },

        })

    }
    setTimeout(function() {
            var Main = {
                methods: {
                    handleCommand(command) {
                        this.$message("click on item " + command);
                        var twoUrl2 = encodeURI(command+".html"); //使用encodeURI编码
                        location.href = twoUrl2;
                    },

                }
            }
            var Ctor = Vue.extend(Main);
            new Ctor().$mount('#el-form-steps');
        },
        2000);





</script>

<style>
    .text {
        font-size: 14px;
    }

    .item {
        margin-bottom: 18px;
    }

    .clearfix:before,
    .clearfix:after {
        display: table;
        content: "";
    }
    .clearfix:after {
        clear: both
    }

    .box-card {
        width: 1020px;
    }
    .el-dropdown-link {
        cursor: pointer;
        color: #eee;
    }

    .el-icon-arrow-down {
        font-size: 12px;
    }

    #LAY_layedit_code {
        text-align: center;
    }
    .layui-tab-item{
        width: 1090px;
        display: none;
    }
</style>

</body>

<!-- import Vue before Element -->
<script src="https://unpkg.com/vue/dist/vue.js"></script>
<!--&lt;!&ndash; import JavaScript &ndash;&gt;-->
<script src="https://unpkg.com/element-ui/lib/index.js"></script>
<!--
<script >




    var Main = {


        methods: {
            handleCommand(command) {
                this.$message('click on item ' + command);
                var twoUrl2 = encodeURI(command+".html"); //使用encodeURI编码
                location.href = twoUrl2;
            },

        }
    }
    var Ctor2 = Vue.extend(Main)

    new Vue().$mount('#el-form-steps')


</script>
-->

</html>
